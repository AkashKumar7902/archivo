{% extends "index.html" %}

{% block content %}
<div class="container">
<h2>Inspect an archived ontology</h2>
<p>Select an ontology to see information about all versions deployed:</p>
<form action="" method="POST" novalidate>
    {{ form.hidden_tag() }}
    {{ form.csrf_token }}
    <p>
        <div style="width: 400px">
            {{ form.uris(**{"onchange":"this.form.submit()"}) }}
        </div>
    </p>
</form>
<br>
{% if general_info.title %}




<h2>{{general_info.title}} (title)</h2>
<p>{{general_info.comment}} (comment)
{% if general_info.hasDev %}
          Swtich: 
          <a  href="/info?o={{general_info.nir.encoded}}" >Official</a>
          <a  href="/info?o={{general_info.nir.encoded}}&dev" > Develop </a>
{% endif %}
</p>

<p>
    <table>
        <tr>
            <td><b>Ontology URI</b></td>
            {% if general_info.sourceURI %}
            <td><b>Source URI</b></td>
            {% endif %}
            <td><b>First Discovery</b></td>
            <td><b>Discovery Source</b></td>
            <td><b>Databus-Artifact</b></td>
        </tr>
        <tr>
            <td><a href="{{general_info.nir.regular}}">{{general_info.nir.regular}}</a></td>
            {% if general_info.sourceURI %}
            <td><a href="{{ general_info.sourceURI }}">{{ general_info.sourceURI }}</a></td>
            {% endif %}
            <td>{{general_info.archivement}}</td>
            <td>{{general_info.source}}</td>
            <td><a href="{{ general_info.databusArtifact }}">Link</a></td>
    </table>
</p>
<br>

<h4>Version-Snapshots:</h4>
<p>Click the version-link to check out the release on the databus for further information!</p>
<div class="container">
    <p>
        <table id="table">
            <tr>
                <th colspan="5" style="text-align: center;">Snapshot Info</th>
                <th colspan="2" style="text-align: center;">Archivo Stars Baseline</th>
                <th colspan="2" style="text-align: center;">Good Practice Stars</th>
            </tr>
            <tr>
                <th><span title="This leads to the release on the Databus. The string is the snapshot time andcan be used in the ReST request.">Snapshot</span></th>
                <th>Triples</th>
                <th>Download</th>
                <th>Semantic Version</th>
                <th><a href="https://github.com/dbpedia/Archivo#stars">Stars</a></th>
                <th><span title="All of the following criteria have to be fulfilled:1) The non-information URI resolves to a machine readable format or a machine readable version of the ontology is deterministically discoverable by other common means. 2) download was successful 3) uses a common format implemented by Archivo 4) at least one format was found that parses with no or few (negligible) syntactical warnings">
                    â˜… Retrieval & Parsing
                </span></th>
                <th><span title="A proper ontology declaration was found using rdf:type owl:Ontology and some form of license could be detected. A high degree of heterogeneity is permissible for this star regarding the used property/subproperty as well as object:license URI (resolvable linked data or web link),xsd:stringorxsd:anyURI">
                    â˜… License I
                </span></th>
                <th><span title="We require a homogenized license declaration using dct:license as object property with a URI (not string or anyURI). ">
                    â˜… License II
                </span></th>
                <th><span title="We measure the compatibility with currently available reasoners such as Pellet/Stardog (more to follow) and run available tasks such as consistency checks and classification.">
                    â˜… Consistency</span>
                </th>
            </tr>
            {% for version in versions_info %}
            <tr>
                <td>
                    <a href="{{version.version.url}}">{{version.version.label}}</a>
                    {% if version.docuURL %}
                        <a href="{{version.docuURL}}">ðŸ“°</a>
                    {% endif %}
                </td>
                <td>{{version.triples}}</td>
                <td>
                    {% if general_info.isDev %}
                    <a href="/download?o={{general_info.nir.encoded}}&f=owl&v={{version.version.label}}&dev">owl</a>,
                    <a href="/download?o={{general_info.nir.encoded}}&f=ttl&v={{version.version.label}}&dev">ttl</a>,
                    <a href="/download?o={{general_info.nir.encoded}}&f=nt&v={{version.version.label}}&dev">nt</a>
                    {% else %}
                    <a href="/download?o={{general_info.nir.encoded}}&f=owl&v={{version.version.label}}">owl</a>,
                    <a href="/download?o={{general_info.nir.encoded}}&f=ttl&v={{version.version.label}}">ttl</a>,
                    <a href="/download?o={{general_info.nir.encoded}}&f=nt&v={{version.version.label}}">nt</a>
                    {% endif %}
                </td>
                <td>{{version.semversion}}</td>
                <td>{{version.stars}}</td>
                <td>
                    {% if version.parsing.conforms %}
                        <span class="check">âœ”</span>
                    {% else %}
                        <span title="{{version.parsing.errors}}" class="x">âœ˜</span>
                    {% endif %}
                </td>
                <td>
                    {% if version.minLicense.conforms %}
                        <a href="/shaclVisualisation?r={{version.minLicense.url}}" target="popup" onclick="window.open('/shaclVisualisation?r={{version.minLicense.url}}', 'popup', 'width=900,height=900')" class="check">âœ”</a>
                    {% else %}
                        <a href="/shaclVisualisation?r={{version.minLicense.url}}" target="popup" onclick="window.open('/shaclVisualisation?r={{version.minLicense.url}}', 'popup', 'width=900,height=900')" class="x">âœ˜</a>
                    {% endif %}
                </td>
                <td>
                    {% if version.goodLicense.conforms %}
                        <a href="/shaclVisualisation?r={{version.goodLicense.url}}" target="popup" onclick="window.open('/shaclVisualisation?r={{version.goodLicense.url}}', 'popup', 'width=900,height=900')" class="check">âœ”</a>
                    {% else %}
                        <a href="/shaclVisualisation?r={{version.goodLicense.url}}" target="popup" onclick="window.open('/shaclVisualisation?r={{version.goodLicense.url}}', 'popup', 'width=900,height=900')" class="x">âœ˜</a>
                    {% endif %}
                </td>
                <td>
                    {% if version.consistent.conforms %}
                        <a href="{{version.consistent.url}}" class="check">âœ”</a>
                    {% else %}
                        <a href="{{version.consistent.url}}" class="x">âœ˜</a>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </table>
    </p>
</div>
<h4>Feature Badges</h4>
<p>Feature badges are additional tests on ontologies, as an example Archivo provides a LODE conformity test.</p>
<div class="container">
    <p>
        <table style="width:400px">
            <tr>
                <th><span title="This leads to the release on the Databus. The string is the snapshot time andcan be used in the ReST request.">Snapshot</span></th>
                <th>&#x1F396;&#xFE0E; Lode-Conform</th>
                <th><a href="https://github.com/dbpedia/Archivo">Write another badge with SHACL!</a></th>
            </tr>
            {% for version in versions_info %}
            <tr>
                <td>
                    <a href="{{version.version.url}}">{{version.version.label}}</a>
                    {% if version.docuURL %}
                        <a href="{{version.docuURL}}">ðŸ“°</a>
                    {% endif %}
                </td>
                <td>
                    {% if version.lode.severity == 'OK' %}
                        <a href="/shaclVisualisation?r={{version.lode.url}}" target="popup" onclick="window.open('/shaclVisualisation?r={{version.lode.url}}', 'popup', 'width=900,height=900')" class="check">âœ”</a>
                    {% elif version.lode.severity == 'INFO' %}
                        <a href="/shaclVisualisation?r={{version.lode.url}}" target="popup" onclick="window.open('/shaclVisualisation?r={{version.lode.url}}', 'popup', 'width=900,height=900')" class="check"><strong>!</strong></a>
                    {% elif version.lode.severity == 'WARNING' %}
                        <a href="/shaclVisualisation?r={{version.lode.url}}" target="popup" onclick="window.open('/shaclVisualisation?r={{version.lode.url}}', 'popup', 'width=900,height=900')" class="yellow"><strong>!</strong></a>
                    {% else %}
                        <a href="/shaclVisualisation?r={{version.lode.url}}" target="popup" onclick="window.open('/shaclVisualisation?r={{version.lode.url}}', 'popup', 'width=900,height=900')" class="x">âœ˜</a>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </table>
    </p>
</div>
{% else %}
<p>{{general_info.message}}</p>
{% endif %}
</div>
<script>
    $(document).ready(function() {
        $('#uris').select2({  // init Select2 on form's uris field
            placeholder: "{{ form.uris.label.text }}",
            allowClear: true,
            "width": 500
        });
    });
  </script>
{% endblock %}
